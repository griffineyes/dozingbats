<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Where's the Bat? Cartoon Night Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Neue', cursive;
            overflow: hidden;
        }
        
        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        .night-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #312e81, #581c87, #312e81);
        }
        
        .star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fef08a;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        .big-star {
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: ping 4s infinite;
        }
        
        .firefly {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #fde047;
            border-radius: 50%;
            opacity: 0.7;
            animation: bounce 3s infinite;
        }
        
        .start-screen, .game-screen, .result-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .game-screen {
            cursor: none;
            z-index: 5;
        }
        
        .start-box, .result-box {
            background: rgba(0, 0, 0, 0.7);
            padding: 2rem;
            border-radius: 1.5rem;
            border: 4px solid #fde047;
            text-align: center;
        }
        
        .title {
            font-size: 3rem;
            font-weight: bold;
            color: #fde047;
            margin-bottom: 1rem;
        }
        
        .subtitle {
            font-size: 1.25rem;
            color: #bfdbfe;
            margin-bottom: 2rem;
        }
        
        .button {
            padding: 1rem 2.5rem;
            background: linear-gradient(to right, #7c3aed, #2563eb);
            color: white;
            border: 2px solid #fde047;
            border-radius: 2rem;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            font-family: 'Comic Neue', cursive;
        }
        
        .button:hover {
            transform: scale(1.05);
        }
        
        .result-button {
            background: linear-gradient(to right, #10b981, #2563eb);
        }
        
        .flashlight-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .illuminated-scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #60a5fa, #93c5fd, #86efac);
        }
        
        .flashlight-indicator {
            position: absolute;
            width: 128px;
            height: 128px;
            border: 4px solid #facc15;
            border-radius: 50%;
            pointer-events: none;
            background: radial-gradient(circle, rgba(255,255,0,0.1) 0%, transparent 70%);
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.4);
        }
        
        .moon {
            position: absolute;
            top: 2rem;
            right: 2rem;
            width: 480px;
            height: 480px;
        }
        
        .bat-container {
            position: absolute;
            transform: translate(-50%, -50%);
            transition: all 0.5s ease-in-out;
        }
        
        .bat-revealed {
            filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.5));
        }
        
        .result-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fde047;
            margin-bottom: 1rem;
        }
        
        .moon-phase-text {
            font-size: 1.125rem;
            color: #bfdbfe;
            margin-bottom: 1rem;
        }
        
        .hidden {
            display: none;
        }
        
        .zoom-in {
            animation: zoomIn 0.8s ease-out;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        @keyframes ping {
            0% { transform: scale(1); opacity: 1; }
            75%, 100% { transform: scale(1.5); opacity: 0; }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes zoomIn {
            from {
                transform: scale(0.1);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <!-- Night Background -->
        <div class="night-background" id="nightBackground"></div>
        
        <!-- Start Screen -->
        <div class="start-screen" id="startScreen">
            <div class="start-box">
                <h1 class="title">ðŸ¦‡ Where's the Bat? ðŸ¦‡</h1>
                <p class="subtitle">Find the hidden bat in the moonlit night!</p>
                <button class="button" onclick="startGame()">ðŸ”¦ Start Hunt</button>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div class="game-screen hidden" id="gameScreen">
            <div class="moon" id="moon"></div>
            <div class="flashlight-area" id="flashlightArea">
                <div class="illuminated-scene" id="illuminatedScene">
                    <!-- Trees will be added here -->
                    <svg class="trees" style="position: absolute; bottom: 0; left: 0; width: 100%; height: 16rem;" viewBox="0 0 1000 200" preserveAspectRatio="none">
                        <rect x="50" y="120" width="20" height="80" fill="#8B4513" />
                        <ellipse cx="60" cy="110" rx="40" ry="35" fill="#228B22" />
                        <ellipse cx="60" cy="95" rx="35" ry="30" fill="#32CD32" />
                        <ellipse cx="60" cy="85" rx="25" ry="25" fill="#7CFC00" />
                        
                        <rect x="200" y="100" width="25" height="100" fill="#8B4513" />
                        <ellipse cx="212" cy="90" rx="50" ry="40" fill="#228B22" />
                        <ellipse cx="212" cy="70" rx="40" ry="35" fill="#32CD32" />
                        <ellipse cx="212" cy="55" rx="30" ry="30" fill="#7CFC00" />
                        
                        <rect x="800" y="110" width="22" height="90" fill="#8B4513" />
                        <ellipse cx="811" cy="100" rx="45" ry="38" fill="#228B22" />
                        <ellipse cx="811" cy="80" rx="38" ry="32" fill="#32CD32" />
                        <ellipse cx="811" cy="68" rx="28" ry="28" fill="#7CFC00" />
                        
                        <rect x="950" y="125" width="18" height="75" fill="#8B4513" />
                        <ellipse cx="959" cy="115" rx="35" ry="32" fill="#228B22" />
                        <ellipse cx="959" cy="100" rx="30" ry="28" fill="#32CD32" />
                        <ellipse cx="959" cy="90" rx="22" ry="22" fill="#7CFC00" />
                        
                        <rect x="0" y="180" width="1000" height="20" fill="#32CD32" />
                    </svg>
                    <div class="bat-container" id="batContainer"></div>
                </div>
            </div>
            <div class="flashlight-indicator" id="flashlightIndicator"></div>
        </div>
        
        <!-- Result Screen -->
        <div class="result-screen hidden" id="resultScreen">
            <div class="result-box">
                <div class="zoom-in" id="resultBat"></div>
                <div class="result-text" id="resultText"></div>
                <div class="moon-phase-text" id="moonPhaseText"></div>
                <button class="button result-button" onclick="resetGame()">ðŸŒ™ Hunt Again?</button>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            started: false,
            batFound: false,
            mousePos: { x: 0, y: 0 },
            batPosition: { x: 0, y: 0 },
            currentPose: 0,
            moonPhase: 0
        };

        // Initialize background elements
        function initBackground() {
            const background = document.getElementById('nightBackground');
            
            // Add stars
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 70 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.animationDuration = (2 + Math.random() * 2) + 's';
                background.appendChild(star);
            }
            
            // Add big twinkling stars
            for (let i = 0; i < 15; i++) {
                const bigStar = document.createElement('div');
                bigStar.className = 'big-star';
                bigStar.style.left = Math.random() * 100 + '%';
                bigStar.style.top = Math.random() * 60 + '%';
                bigStar.style.animationDelay = Math.random() * 4 + 's';
                bigStar.style.animationDuration = (3 + Math.random() * 2) + 's';
                background.appendChild(bigStar);
            }
            
            // Add fireflies
            for (let i = 0; i < 8; i++) {
                const firefly = document.createElement('div');
                firefly.className = 'firefly';
                firefly.style.left = (20 + Math.random() * 60) + '%';
                firefly.style.top = (60 + Math.random() * 30) + '%';
                firefly.style.animationDelay = Math.random() * 2 + 's';
                firefly.style.animationDuration = (2 + Math.random() * 3) + 's';
                background.appendChild(firefly);
            }
        }

        // Moon phases
        function createMoonPhase(phase) {
            const moonPhases = [
                // New Moon
                '<circle cx="50" cy="50" r="20" fill="#1a1a2e" stroke="#4a4a6a" stroke-width="2" />',
                // Waxing Crescent
                '<circle cx="50" cy="50" r="20" fill="#1a1a2e" stroke="#4a4a6a" stroke-width="2" /><path d="M 50 30 A 20 20 0 0 1 50 70 A 15 15 0 0 0 50 30" fill="#f5f5dc" />',
                // First Quarter
                '<circle cx="50" cy="50" r="20" fill="#1a1a2e" stroke="#4a4a6a" stroke-width="2" /><path d="M 50 30 A 20 20 0 0 1 50 70 Z" fill="#f5f5dc" />',
                // Waxing Gibbous
                '<circle cx="50" cy="50" r="20" fill="#1a1a2e" stroke="#4a4a6a" stroke-width="2" /><path d="M 50 30 A 20 20 0 0 1 50 70 A 8 8 0 0 1 50 30" fill="#f5f5dc" />',
                // Full Moon
                '<circle cx="50" cy="50" r="20" fill="#f5f5dc" stroke="#e6e68a" stroke-width="2" />',
                // Waning Gibbous
                '<circle cx="50" cy="50" r="20" fill="#f5f5dc" stroke="#e6e68a" stroke-width="2" /><path d="M 50 30 A 8 8 0 0 1 50 70 A 20 20 0 0 0 50 30" fill="#1a1a2e" />',
                // Last Quarter
                '<circle cx="50" cy="50" r="20" fill="#f5f5dc" stroke="#e6e68a" stroke-width="2" /><path d="M 50 30 A 20 20 0 0 0 50 70 Z" fill="#1a1a2e" />',
                // Waning Crescent
                '<circle cx="50" cy="50" r="20" fill="#f5f5dc" stroke="#e6e68a" stroke-width="2" /><path d="M 50 30 A 15 15 0 0 1 50 70 A 20 20 0 0 0 50 30" fill="#1a1a2e" />'
            ];
            
            let moonSvg = `<svg width="480" height="480" viewBox="0 0 100 100">${moonPhases[phase]}`;
            
            // Add craters for full phases
            if (phase === 4 || phase === 5 || phase === 6) {
                moonSvg += '<circle cx="45" cy="45" r="3" fill="#e6e68a" opacity="0.7" />';
                moonSvg += '<circle cx="58" cy="52" r="2" fill="#e6e68a" opacity="0.7" />';
                moonSvg += '<circle cx="52" cy="60" r="2.5" fill="#e6e68a" opacity="0.7" />';
            }
            
            moonSvg += '</svg>';
            return moonSvg;
        }

        // Bat SVGs
        function createBatSVG(isRevealed, pose) {
            const size = isRevealed ? 200 : 80;
            const poses = [
                // Sleeping Bat (pose 0)
                `<svg width="${size}" height="${size}" viewBox="0 0 100 100">
                    <rect x="20" y="15" width="60" height="6" fill="#4a3728" rx="3" />
                    <ellipse cx="35" cy="15" rx="3" ry="2" fill="#5d4537" />
                    <ellipse cx="65" cy="15" rx="3" ry="2" fill="#5d4537" />
                    <ellipse cx="35" cy="18" rx="2" ry="4" fill="#333" />
                    <ellipse cx="65" cy="18" rx="2" ry="4" fill="#333" />
                    <ellipse cx="50" cy="55" rx="18" ry="25" fill="#4a4a4a" stroke="#333" stroke-width="2" />
                    <circle cx="50" cy="75" r="12" fill="#666" stroke="#333" stroke-width="2" />
                    <ellipse cx="44" cy="68" rx="4" ry="8" fill="#555" stroke="#333" stroke-width="1" />
                    <ellipse cx="56" cy="68" rx="4" ry="8" fill="#555" stroke="#333" stroke-width="1" />
                    ${!isRevealed ? 
                        '<path d="M 45 74 C 47 74 47 74 47 74" stroke="#000" stroke-width="2" stroke-linecap="round"/><path d="M 53 74 C 55 74 55 74 55 74" stroke="#000" stroke-width="2" stroke-linecap="round"/>' :
                        '<rect x="40" y="72" width="20" height="4" rx="2" fill="#000" /><rect x="42" y="73" width="6" height="2" rx="1" fill="#333" /><rect x="52" y="73" width="6" height="2" rx="1" fill="#333" /><text x="62" y="65" font-size="8" fill="#87ceeb">Z</text><text x="68" y="60" font-size="6" fill="#87ceeb">z</text><text x="72" y="56" font-size="4" fill="#87ceeb">z</text>'
                    }
                    <ellipse cx="50" cy="77" rx="2" ry="1" fill="#000" />
                </svg>`,
                
                // Flying Bat (pose 1)
                `<svg width="${size}" height="${size}" viewBox="0 0 100 100">
                    <ellipse cx="25" cy="45" rx="15" ry="8" fill="#4a4a4a" stroke="#333" stroke-width="2" transform="rotate(-20 25 45)" />
                    <ellipse cx="75" cy="45" rx="15" ry="8" fill="#4a4a4a" stroke="#333" stroke-width="2" transform="rotate(20 75 45)" />
                    <ellipse cx="50" cy="50" rx="8" ry="15" fill="#666" stroke="#333" stroke-width="2" />
                    <circle cx="50" cy="35" r="10" fill="#666" stroke="#333" stroke-width="2" />
                    <ellipse cx="46" cy="28" rx="3" ry="6" fill="#555" stroke="#333" stroke-width="1" />
                    <ellipse cx="54" cy="28" rx="3" ry="6" fill="#555" stroke="#333" stroke-width="1" />
                    ${!isRevealed ? 
                        '<circle cx="46" cy="33" r="2" fill="#000" /><circle cx="54" cy="33" r="2" fill="#000" />' :
                        '<rect x="42" y="31" width="16" height="4" rx="2" fill="#000" /><rect x="44" y="32" width="5" height="2" rx="1" fill="#333" /><rect x="51" y="32" width="5" height="2" rx="1" fill="#333" /><path d="M 46 38 Q 50 40 54 38" stroke="#000" stroke-width="1.5" fill="none" stroke-linecap="round"/>'
                    }
                    <ellipse cx="50" cy="36" rx="1.5" ry="1" fill="#000" />
                </svg>`,
                
                // Alert Bat (pose 2)
                `<svg width="${size}" height="${size}" viewBox="0 0 100 100">
                    <rect x="25" y="80" width="50" height="6" fill="#4a3728" rx="3" />
                    <ellipse cx="40" cy="80" rx="2" ry="3" fill="#333" />
                    <ellipse cx="60" cy="80" rx="2" ry="3" fill="#333" />
                    <ellipse cx="35" cy="55" rx="10" ry="12" fill="#4a4a4a" stroke="#333" stroke-width="2" transform="rotate(-15 35 55)" />
                    <ellipse cx="65" cy="55" rx="10" ry="12" fill="#4a4a4a" stroke="#333" stroke-width="2" transform="rotate(15 65 55)" />
                    <ellipse cx="50" cy="60" rx="8" ry="18" fill="#666" stroke="#333" stroke-width="2" />
                    <circle cx="50" cy="35" r="12" fill="#666" stroke="#333" stroke-width="2" />
                    <ellipse cx="45" cy="25" rx="3" ry="8" fill="#555" stroke="#333" stroke-width="1" />
                    <ellipse cx="55" cy="25" rx="3" ry="8" fill="#555" stroke="#333" stroke-width="1" />
                    ${!isRevealed ? 
                        '<circle cx="46" cy="33" r="3" fill="#000" /><circle cx="54" cy="33" r="3" fill="#000" /><circle cx="46" cy="32" r="1" fill="#fff" /><circle cx="54" cy="32" r="1" fill="#fff" />' :
                        '<rect x="38" y="31" width="24" height="4" rx="2" fill="#000" /><rect x="40" y="32" width="8" height="2" rx="1" fill="#333" /><rect x="52" y="32" width="8" height="2" rx="1" fill="#333" />'
                    }
                    <ellipse cx="50" cy="37" rx="2" ry="1" fill="#000" />
                </svg>`,
                
                // Vampire Bat (pose 3)
                `<svg width="${size}" height="${size}" viewBox="0 0 100 100">
                    <path d="M 20 50 Q 15 40 25 45 Q 35 35 45 50" fill="#1a1a1a" stroke="#000" stroke-width="2" />
                    <path d="M 55 50 Q 65 35 75 45 Q 85 40 80 50" fill="#1a1a1a" stroke="#000" stroke-width="2" />
                    <ellipse cx="50" cy="55" rx="10" ry="18" fill="#333" stroke="#000" stroke-width="2" />
                    <path d="M 42 42 Q 50 38 58 42 Q 55 48 50 46 Q 45 48 42 42" fill="#8b0000" stroke="#000" stroke-width="1" />
                    <circle cx="50" cy="35" r="12" fill="#666" stroke="#000" stroke-width="2" />
                    <path d="M 43 28 L 40 20 L 46 26 Z" fill="#555" stroke="#000" stroke-width="1" />
                    <path d="M 57 28 L 54 26 L 60 20 Z" fill="#555" stroke="#000" stroke-width="1" />
                    ${!isRevealed ? 
                        '<circle cx="46" cy="32" r="2.5" fill="#ff0000" /><circle cx="54" cy="32" r="2.5" fill="#ff0000" />' :
                        '<rect x="38" y="30" width="24" height="4" rx="2" fill="#000" /><rect x="40" y="31" width="8" height="2" rx="1" fill="#333" /><rect x="52" y="31" width="8" height="2" rx="1" fill="#333" /><path d="M 45 39 Q 50 42 55 39" stroke="#8b0000" stroke-width="2" fill="none" stroke-linecap="round"/>'
                    }
                    <ellipse cx="50" cy="36" rx="2" ry="1" fill="#000" />
                    <path d="M 47 37 L 47 41 L 48 37 Z" fill="#fff" />
                    <path d="M 52 37 L 52 41 L 53 37 Z" fill="#fff" />
                </svg>`
            ];
            
            return poses[pose];
        }

        // Sound effects
        async function playSound(type) {
            await Tone.start();
            
            if (type === 'start') {
                const synth = new Tone.Synth({
                    oscillator: { type: "triangle" },
                    envelope: { attack: 0.3, decay: 0.5, sustain: 0.3, release: 0.8 }
                }).toDestination();
                synth.triggerAttackRelease("G4", "2n");
                setTimeout(() => synth.triggerAttackRelease("B4", "2n"), 300);
                setTimeout(() => synth.triggerAttackRelease("D5", "1n"), 600);
                setTimeout(() => synth.dispose(), 2000);
            } else if (type === 'click') {
                const synth = new Tone.Synth({
                    oscillator: { type: "sine" },
                    envelope: { attack: 0.01, decay: 0.2, sustain: 0, release: 0.1 }
                }).toDestination();
                synth.triggerAttackRelease("C5", "32n");
                setTimeout(() => synth.dispose(), 200);
            } else if (type === 'found') {
                const synth = new Tone.PolySynth().toDestination();
                synth.triggerAttackRelease(["E4", "G#4", "B4", "E5"], "4n");
                
                setTimeout(() => {
                    const sparkleSynth = new Tone.Synth({
                        oscillator: { type: "sine" },
                        envelope: { attack: 0.01, decay: 0.3, sustain: 0, release: 0.2 }
                    }).toDestination();
                    sparkleSynth.volume.value = -10;
                    sparkleSynth.triggerAttackRelease("G5", "16n");
                    setTimeout(() => sparkleSynth.triggerAttackRelease("B5", "16n"), 100);
                    setTimeout(() => sparkleSynth.triggerAttackRelease("D6", "16n"), 200);
                    setTimeout(() => sparkleSynth.dispose(), 500);
                }, 100);
                
                setTimeout(() => synth.dispose(), 1000);
            }
        }

        // Game functions
        function startGame() {
            gameState.batPosition.x = Math.random() * 70 + 15;
            gameState.batPosition.y = Math.random() * 60 + 20;
            gameState.currentPose = Math.floor(Math.random() * 4);
            gameState.moonPhase = Math.floor(Math.random() * 8);
            gameState.started = true;
            gameState.batFound = false;
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            // Set up moon
            document.getElementById('moon').innerHTML = createMoonPhase(gameState.moonPhase);
            
            // Set up bat
            const batContainer = document.getElementById('batContainer');
            batContainer.innerHTML = createBatSVG(false, gameState.currentPose);
            batContainer.style.left = gameState.batPosition.x + '%';
            batContainer.style.top = gameState.batPosition.y + '%';
            
            playSound('start');
        }

        function resetGame() {
            gameState.started = false;
            gameState.batFound = false;
            
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }

        function getMoonPhaseName(phase) {
            const names = ["New Moon", "Waxing Crescent", "First Quarter", "Waxing Gibbous", 
                           "Full Moon", "Waning Gibbous", "Last Quarter", "Waning Crescent"];
            return names[phase];
        }

        function checkBatClick(event) {
            if (!gameState.batFound) {
                const rect = document.getElementById('gameContainer').getBoundingClientRect();
                const clickX = ((event.clientX - rect.left) / rect.width) * 100;
                const clickY = ((event.clientY - rect.top) / rect.height) * 100;
                
                const distance = Math.sqrt(
                    Math.pow(clickX - gameState.batPosition.x, 2) + 
                    Math.pow(clickY - gameState.batPosition.y, 2)
                );
                
                const mouseX = event.clientX - rect.left;
                const mouseY = event.clientY - rect.top;
                const flashlightDistance = Math.sqrt(
                    Math.pow(mouseX - gameState.mousePos.x, 2) + 
                    Math.pow(mouseY - gameState.mousePos.y, 2)
                );
                
                if (flashlightDistance < 60 && distance < 12) {
                    gameState.batFound = true;
                    
                    // Show result screen
                    document.getElementById('gameScreen').classList.add('hidden');
                    document.getElementById('resultScreen').classList.remove('hidden');
                    
                    // Set up result
                    const resultTexts = [
                        "ðŸ’¤ SLEEPY BAT! ðŸ’¤",
                        "ðŸ¦‡ FLYING HIGH! ðŸ¦‡", 
                        "ðŸ‘ï¸ WIDE AWAKE! ðŸ‘ï¸",
                        "ðŸ§› SPOOKY BAT! ðŸ§›"
                    ];
                    
                    document.getElementById('resultBat').innerHTML = createBatSVG(true, gameState.currentPose);
                    document.getElementById('resultText').textContent = resultTexts[gameState.currentPose];
                    document.getElementById('moonPhaseText').textContent = `Found under the ${getMoonPhaseName(gameState.moonPhase)}!`;
                    
                    playSound('found');
                } else {
                    playSound('click');
                }
            }
        }

        // Mouse tracking
        document.addEventListener('mousemove', (event) => {
            if (gameState.started && !gameState.batFound) {
                const rect = document.getElementById('gameContainer').getBoundingClientRect();
                gameState.mousePos.x = event.clientX - rect.left;
                gameState.mousePos.y = event.clientY - rect.top;
                
                const illuminatedScene = document.getElementById('illuminatedScene');
                const flashlightIndicator = document.getElementById('flashlightIndicator');
                
                // Update mask position
                illuminatedScene.style.webkitMaskImage = `radial-gradient(circle 60px at ${gameState.mousePos.x}px ${gameState.mousePos.y}px, white 0%, white 100%, transparent 100%)`;
                illuminatedScene.style.maskImage = `radial-gradient(circle 60px at ${gameState.mousePos.x}px ${gameState.mousePos.y}px, white 0%, white 100%, transparent 100%)`;
                
                // Update flashlight indicator position
                flashlightIndicator.style.left = (gameState.mousePos.x - 64) + 'px';
                flashlightIndicator.style.top = (gameState.mousePos.y - 64) + 'px';
            }
        });

        // Click handler
        document.getElementById('gameScreen').addEventListener('click', checkBatClick);

        // Initialize the game
        initBackground();
    </script>
</body>
</html>